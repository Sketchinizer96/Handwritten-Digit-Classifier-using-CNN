
import os
import pandas as pd

def count_files_in_subfolders(parent_folder):
    subfolder_counts = []

    for root, dirs, files in os.walk(parent_folder):
        # Check if the current directory is a subfolder of the parent folder
        if root != parent_folder:
            subfolder_name = os.path.basename(root)
            subfolder_counts.append((subfolder_name, len(files)))
    
    return subfolder_counts

def save_to_excel(subfolder_counts, output_file):
    df = pd.DataFrame(subfolder_counts, columns=['Subfolder', 'File Count'])
    df.to_excel(output_file, index=False)

def main():
    parent_folder = input("Enter the path to the parent folder: ")
    if not os.path.isdir(parent_folder):
        print("The provided path is not a valid directory.")
        return
    
    output_file = input("Enter the path to the output Excel file (e.g., output.xlsx): ")

    subfolder_counts = count_files_in_subfolders(parent_folder)
    save_to_excel(subfolder_counts, output_file)
    print(f"Results have been saved to {output_file}")

if __name__ == "__main__":
    main()